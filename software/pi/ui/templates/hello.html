<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <title>RAPID Interface</title>
    </head>
    <body onload="loadImage()">
        <p> This is the Rapid Acceleration PI Device (RAPID)
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <ul>
                    {% for message in messages %}
                        <li>{{ message[1] }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}
        <p id="p1"></p>
        <img src="/static/test.jpg" id="img">
        <script>
        function loadImage() {
            var intervalID = setInterval(timer, 500);
        }

        function timer() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                 document.getElementById("p1").innerHTML = this.responseText;
                }
              };
            xhttp.open("GET", "/distance", true);
            xhttp.send();

            var xhttpimg = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                 document.getElementById("img").innerHTML = this.responseText;
                }
              };
            xhttpimg.open("GET", "/distance", true);
            xhttpimg.send();
        }
       </script>

        <form action="" method="post">
            {{ form.csrf }}

            <div class="input text">
                {{ form.name.label }} {{ form.name }}
            </div>

            <div class="input submit">
                <input type="submit" value="Submit" />
            </div>
        </form>
    </body>
</html>